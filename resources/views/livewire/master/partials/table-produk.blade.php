<table class="text-[10px] text-left border-collapse whitespace-nowrap min-w-max w-full">
    <thead class="text-slate-500 uppercase bg-slate-50 font-bold border-b border-slate-200 sticky top-0 z-20 shadow-sm">
        <tr>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 sticky left-0 z-30 shadow-sm">Cabang</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 sticky left-[60px] z-30 shadow-sm">C-Code</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 sticky left-[120px] z-30 shadow-sm">SKU</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Kategori</th>
            <th
                class="px-3 py-3 border-r border-slate-200 bg-slate-100 min-w-[200px] text-slate-700 sticky left-[180px] z-30 shadow-sm">
                Nama Item</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Expired Date</th>
            <th class="px-3 py-3 border-r border-blue-100 bg-blue-50 text-blue-700 text-right font-extrabold">Stok</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-center">OUM</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Good</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Good Konv</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">KTN</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Good Amount</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Avg 3M (OUM)</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Avg 3M (KTN)</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Avg 3M (Val)</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Not Move 3M</th>

            <th class="px-3 py-3 border-r border-red-100 bg-red-50 text-red-700 text-right">Bad</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Bad Konv</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Bad KTN</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Bad Amount</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 1</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 1 Konv</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 1 Amt</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 2</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 2 Konv</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 2 Amt</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 3</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 3 Konv</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Wrh 3 Amt</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Good Storage</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Sell/Week</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Blank</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Empty</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Min</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right font-bold text-orange-500">Re Qty</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Expired Info</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Buy</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Buy Disc</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Buy KTN</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Avg</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right font-bold">Total</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">UP</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Fix</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">PPN</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50 text-right">Fix Exc PPN</th>
            <th class="px-3 py-3 border-r border-yellow-200 bg-yellow-50 text-right text-yellow-700">Margin</th>
            <th class="px-3 py-3 border-r border-yellow-200 bg-yellow-50 text-right text-yellow-700">% Margin</th>

            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Order No</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Supplier</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Mother SKU</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Last Supplier</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Divisi</th>
            <th class="px-3 py-3 border-r border-slate-200 bg-slate-50">Unique ID</th>

            <th
                class="px-3 py-3 text-center bg-slate-100 border-l border-slate-200 sticky right-0 z-30 w-16 font-bold text-slate-700">
                Aksi</th>
        </tr>
    </thead>

    <tbody class="divide-y divide-slate-100 bg-white">
        @forelse($produks as $item)
        <tr
            class="hover:bg-emerald-50/20 transition-colors {{ $item->is_duplicate ? 'bg-red-50/50' : '' }} group odd:bg-white even:bg-slate-50/30">

            <td class="px-3 py-2 border-r border-slate-100 text-indigo-600 font-bold sticky left-0 bg-inherit z-10">
                {{ $item->cabang }}</td>
            <td class="px-3 py-2 border-r border-slate-100 font-mono text-slate-500 sticky left-[60px] bg-inherit z-10">
                {{ $item->ccode }}</td>
            <td
                class="px-3 py-2 border-r border-slate-100 font-mono font-bold text-slate-700 sticky left-[120px] bg-inherit z-10">
                {{ $item->sku }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-slate-600">{{ $item->kategori }}</td>
            <td class="px-3 py-2 border-r border-slate-100 font-bold text-slate-700 truncate max-w-[250px] sticky left-[180px] bg-inherit z-10 shadow-sm"
                title="{{ $item->name_item }}">
                {{ $item->name_item }}
                @if($item->is_duplicate) <span
                    class="ml-1 inline-flex items-center px-1.5 py-0.5 rounded text-[8px] font-bold bg-red-100 text-red-600 border border-red-200">DUP</span>
                @endif
            </td>

            <td class="px-3 py-2 border-r border-slate-100 text-slate-600">{{ $item->expired_date }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right font-extrabold text-blue-700 bg-blue-50/20">
                {{ number_format((float)$item->stok, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-center text-[10px] uppercase text-slate-400 font-bold">
                {{ $item->oum }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->good }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->good_konversi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->ktn }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->good_amount, 0, ',', '.') }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->avg_3m_in_oum }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->avg_3m_in_ktn }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->avg_3m_in_value, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->not_move_3m }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right text-red-600 font-bold">{{ $item->bad }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->bad_konversi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->bad_ktn }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->bad_amount, 0, ',', '.') }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh1 }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh1_konversi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh1_amount }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh2 }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh2_konversi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh2_amount }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh3 }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh3_konversi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->wrh3_amount }}</td>

            <td class="px-3 py-2 border-r border-slate-100">{{ $item->good_storage }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->sell_per_week }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->blank_field }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->empty_field }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">{{ $item->min }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right font-bold text-orange-500">{{ $item->re_qty }}
            </td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->expired_info }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->buy, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->buy_disc, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->buy_in_ktn, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->avg, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right font-bold">
                {{ number_format((float)$item->total, 0, ',', '.') }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->up, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->fix, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->ppn, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->fix_exc_ppn, 0, ',', '.') }}</td>

            <td class="px-3 py-2 border-r border-slate-100 text-right font-bold text-emerald-600 bg-emerald-50/20">
                {{ number_format((float)$item->margin, 0, ',', '.') }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-right">
                {{ number_format((float)$item->percent_margin, 2, ',', '.') }}%</td>

            <td class="px-3 py-2 border-r border-slate-100">{{ $item->order_no }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-purple-600 font-medium truncate max-w-[150px]">
                {{ $item->supplier }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->mother_sku }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->last_supplier }}</td>
            <td class="px-3 py-2 border-r border-slate-100">{{ $item->divisi }}</td>
            <td class="px-3 py-2 border-r border-slate-100 text-[9px] text-slate-400 font-mono">{{ $item->unique_id }}
            </td>

            <td
                class="px-3 py-2 text-center sticky right-0 bg-white border-l border-slate-100 z-10 group-hover:bg-emerald-50/20">
                <button wire:click="delete({{ $item->id }})"
                    onclick="return confirm('Yakin ingin menghapus produk ini?') || event.stopImmediatePropagation()"
                    class="w-7 h-7 rounded-lg flex items-center justify-center text-slate-400 hover:text-white hover:bg-rose-500 transition-all shadow-sm"
                    title="Hapus Data">
                    <i class="fas fa-trash-alt text-xs"></i>
                </button>
            </td>
        </tr>
        @empty
        <tr>
            <td colspan="53" class="px-6 py-20 text-center">
                <div class="flex flex-col items-center justify-center">
                    <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-3">
                        <i class="fas fa-box-open text-3xl text-slate-300"></i>
                    </div>
                    <h3 class="text-slate-800 font-bold text-base">Data Produk Kosong</h3>
                    <p class="text-slate-400 text-xs mt-1">Belum ada data produk yang diimport.</p>
                </div>
            </td>
        </tr>
        @endforelse
    </tbody>
</table>